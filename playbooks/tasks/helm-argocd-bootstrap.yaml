- name: Install ArgoCD CRDs
  ansible.builtin.shell: |
    kubectl apply -k https://github.com/argoproj/argo-cd/manifests/crds\?ref\=stable

- name: Clone bootstrap Helm repository
  ansible.builtin.git:
    repo: https://github.com/aidenharwood/portfolio-helm-argocd-bootstrap.git
    dest: /tmp/bootstrap-helm-argocd

- name: Deploy bootstrap chart from local path
  kubernetes.core.helm:
    name: argocd-bootstrap
    chart_ref: /tmp/bootstrap-helm-argocd
    release_namespace: argocd
    values:
      repo: https://github.com/aidenharwood/portfolio-helm-argocd-bootstrap.git
